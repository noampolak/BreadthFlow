{% extends "base.html" %}

{% block title %}BreadthFlow Dashboard{% endblock %}
{% block header_title %}BreadthFlow Pipeline Dashboard{% endblock %}
{% block active_page %}dashboard{% endblock %}

{% block refresh_button %}
<button class="refresh-btn" onclick="loadData()">Refresh Now</button>
{% endblock %}

{% block content %}
<div class="stats">
    <div class="stat-card">
        <div class="stat-value" id="total-runs">-</div>
        <div class="stat-label">Total Pipeline Runs</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="success-rate">-</div>
        <div class="stat-label">Success Rate</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="recent-runs">-</div>
        <div class="stat-label">Last 24h Runs</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="avg-duration">-</div>
        <div class="stat-label">Avg Duration (s)</div>
    </div>
</div>

<div class="runs-section">
    <h2>Recent Pipeline Runs</h2>
    <table class="runs-table">
        <thead>
            <tr>
                <th>Command</th>
                <th>Status</th>
                <th>Duration</th>
                <th>Start Time</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="runs-tbody">
            <tr><td colspan="5">Loading...</td></tr>
        </tbody>
    </table>
    
    <!-- Pagination Controls -->
    <div class="pagination-container" id="pagination-container" style="display: none;">
        <div class="pagination-info">
            <span id="pagination-info">Showing 0-0 of 0 runs</span>
        </div>
        <div class="pagination-controls">
            <button id="prev-page" class="pagination-btn" onclick="changePage(-1)" disabled>← Previous</button>
            <span id="page-numbers" class="page-numbers"></span>
            <button id="next-page" class="pagination-btn" onclick="changePage(1)" disabled>Next →</button>
        </div>
    </div>
    
    <div class="last-updated" id="last-updated">Last updated: Never</div>
</div>
{% endblock %}

{% block modals %}
<!-- Run Details Modal -->
<div id="runModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <div id="modalContent">Loading...</div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/dashboard.js"></script>
{% endblock %}
